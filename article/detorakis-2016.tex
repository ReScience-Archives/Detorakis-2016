\documentclass[10pt,a4paper,onecolumn]{article}
% \usepackage[utf8]{inputenc}
\usepackage{marginnote}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{authblk,etoolbox}
\usepackage{titlesec}
\usepackage{calc}
\usepackage{hyperref}
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor=
{
      Georgios Detorakis,
  },
            pdftitle=
{
[Re] Multiple dynamical modes of thalamic relay neurons: rhythmic bursting
        and intermittent phase-locking
},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=blue,
            pdfborder={0 0 0}}
\urlstyle{same}
\usepackage{tcolorbox}
\usepackage{ragged2e}
\usepackage{fontspec}
\usepackage{fontawesome}
\usepackage{caption}
\usepackage{listings}
\usepackage{float,lscape}
\usepackage{xcolor,colortbl}
\usepackage{amssymb,amsmath,array,amsthm}
\usepackage{marvosym}
\usepackage{array}
\usepackage[export]{adjustbox}

\newcommand{\Rm}[1]{\mathrm{#1}}

\makeatletter
\newcommand{\thickhline}{%
    \noalign {\ifnum 0=`}\fi \hrule height 1pt
    \futurelet \reserved@a \@xhline
}
\newcolumntype{"}{@{\hskip\tabcolsep\vrule width 1pt\hskip\tabcolsep}}
\makeatother

\definecolor{Gray}{gray}{0.75}
\definecolor{LightGray}{gray}{0.95}
\lstnewenvironment{code}{\lstset{language=Haskell,basicstyle=\small\ttfamily}}{}



%\usepackage{fancyvrb}
%\VerbatimFootnotes
%\usepackage{graphicx}
%\usepackage{mdframed}
%\newmdenv[backgroundcolor=lightgray]{Shaded}


\usepackage{longtable,booktabs}

\usepackage[
  backend=biber,
%  style=alphabetic,
%  citestyle=numeric
]{biblatex}
\bibliography{detorakis-2016.bib}



% --- Macros ------------------------------------------------------------------
\renewcommand*{\bibfont}{\small \sffamily}

\definecolor{red}{HTML}{CF232B}
\newcommand{\ReScience}{Re{\bfseries \textcolor{red}{Science}}}

\newtcolorbox{rebox}
   {colback=blue!5!white, colframe=blue!40!white,
     boxrule=0.5pt, arc=2pt, fonttitle=\sffamily\scshape\bfseries,
     left=6pt, right=20pt, top=6pt, bottom=6pt}

\newtcolorbox{repobox}
   {colback=red, colframe=red!75!black,
     boxrule=0.5pt, arc=2pt, left=6pt, right=6pt, top=3pt, bottom=3pt}

% fix for pandoc 1.14     
\newcommand{\tightlist}{%
  \setlength{\itemsep}{1pt}\setlength{\parskip}{0pt}\setlength{\parsep}{0pt}}

% --- Style -------------------------------------------------------------------
\renewcommand*{\bibfont}{\small \sffamily}
\renewcommand{\captionfont}{\small\sffamily}
\renewcommand{\captionlabelfont}{\bfseries}

\makeatletter
\renewcommand\@biblabel[1]{{\bf #1.}}
\makeatother

% --- Page layout -------------------------------------------------------------
\usepackage[top=3.5cm, bottom=3cm, right=1.5cm, left=1.5cm,
            headheight=2.2cm, reversemp, includemp, marginparwidth=4.5cm]{geometry}

% --- Section/SubSection/SubSubSection ----------------------------------------
\titleformat{\section}
  {\normalfont\sffamily\Large\bfseries}
  {}{0pt}{}
\titleformat{\subsection}
  {\normalfont\sffamily\large\bfseries}
  {}{0pt}{}
\titleformat{\subsubsection}
  {\normalfont\sffamily\bfseries}
  {}{0pt}{}
\titleformat*{\paragraph}
  {\sffamily\normalsize}


% --- Header / Footer ---------------------------------------------------------
\usepackage{fancyhdr}
\pagestyle{fancy}
%\renewcommand{\headrulewidth}{0.50pt}
\renewcommand{\headrulewidth}{0pt}
\fancyhead[L]{\hspace{-1cm}\includegraphics[width=4.0cm]{rescience-logo.pdf}}
\fancyhead[C]{}
\fancyhead[R]{} 
\renewcommand{\footrulewidth}{0.25pt}

\fancyfoot[L]{\hypersetup{urlcolor=red}
              \sffamily \ReScience~$\vert$
              \href{http://rescience.github.io}{rescience.github.io}
              \hypersetup{urlcolor=blue}}
\fancyfoot[C]{\sffamily \thepage}
\fancyfoot[R]{\sffamily Sep 2015 $\vert$
                        Volume \textbf{1} $\vert$
                        Issue \textbf{1}}
\pagestyle{fancy}
\makeatletter
\let\ps@plain\ps@fancy
\fancyheadoffset[L]{4.5cm}
\fancyfootoffset[L]{4.5cm}

% --- Title / Authors ---------------------------------------------------------
% patch \maketitle so that it doesn't center
\patchcmd{\@maketitle}{center}{flushleft}{}{}
\patchcmd{\@maketitle}{center}{flushleft}{}{}
% patch \maketitle so that the font size for the title is normal
\patchcmd{\@maketitle}{\LARGE}{\LARGE\sffamily}{}{}
% patch the patch by authblk so that the author block is flush left
\def\maketitle{{%
  \renewenvironment{tabular}[2][]
    {\begin{flushleft}}
    {\end{flushleft}}
  \AB@maketitle}}
\makeatletter
\renewcommand\AB@affilsepx{ \protect\Affilfont}
%\renewcommand\AB@affilnote[1]{{\bfseries #1}\hspace{2pt}}
\renewcommand\AB@affilnote[1]{{\bfseries #1}\hspace{3pt}}
\makeatother
\renewcommand\Authfont{\sffamily\bfseries}
\renewcommand\Affilfont{\sffamily\small\mdseries}
\setlength{\affilsep}{1em}

\LetLtxMacro{\OldIncludegraphics}{\includegraphics}
\renewcommand{\includegraphics}[2][]{\OldIncludegraphics[width=12cm, #1]{#2}}


% --- Document ----------------------------------------------------------------
\title{[Re] Multiple dynamical modes of thalamic relay neurons: 
        rhythmic bursting and intermittent phase-locking}

    \usepackage{authblk}
                        \author[1]{Georgios Detorakis}
                        \affil[1]{ Department of Cognitive Sciences, UC Irvine, CA, USA}
            
\date{\vspace{-5mm}
    \sffamily \small \href{mailto:gdetorak@uci.edu}{gdetorak@uci.edu}}


\setlength\LTleft{0pt}
\setlength\LTright{0pt}


\begin{document}
\maketitle

\marginpar{
  %\hrule
  \sffamily\small
  %\vspace{2mm}
  {\bfseries Editor}\\
  Name Surname\\

  {\bfseries Reviewers}\\
        Name Surname\\
        Name Surname\\
  
  {\bfseries Received}  Sep, 1, 2015\\
  {\bfseries Accepted}  Sep, 1, 2015\\
  {\bfseries Published} Sep, 1, 2015\\

  {\bfseries Licence}   \href{http://creativecommons.org/licenses/by/4.0/}{CC-BY}

  \begin{flushleft}
  {\bfseries Competing Interests:}\\
  The authors have declared that no competing interests exist.
  \end{flushleft}

  \hrule
  \vspace{3mm}

  \hypersetup{urlcolor=white}
  
    \vspace{-1mm}
  \begin{repobox}
    \bfseries\normalsize
      \href{http://github.com/rescience/rescience-submission/article}{\faGithubAlt~Article repository}
  \end{repobox}
      \vspace{-1mm}
  \begin{repobox}
    \bfseries\normalsize
      \href{http://github.com/rescience/rescience-submission/code}{\faGithubAlt~Code repository}
  \end{repobox}
        \hypersetup{urlcolor=blue}
}

\begin{rebox}
\sffamily {\bfseries A reference implementation of}
\small
\begin{flushleft}
\begin{itemize}
    \item[â†’] \emph{Multiple dynamical modes of thalamic relay neurons: rhythmic
        bursting and intermittent phase-locking}, Wang, X-J, Neuroscience,
        59(1), pg. 21--31, 1994.
  \end{itemize}\par
\end{flushleft}
\end{rebox}


\section{Introduction}\label{introduction}

This work introduces a reference implementation of a neuron model for
thalamocortical relay neurons, proposed by X-J Wang, \cite{wang:1994}.
The model is conductance-based and takes advantage of an interplay between
a T-type calcium current and a non-specific cation sag current and thus, it
is able to generate spindle and delta rhythms. Another feature of this model
is the presence of an intermittent phase-locking phenomenon where action 
potentials of sodium take place in a non-periodic manner, despite the fact
that they are phase-locked to the periodic input current. Finally, the model
is capable of generating tonic spike patterns. The source code of
reference implementation is written in Python (Numpy, Scipy, Matplotlib,
and Scikit-image).


\section{Methods}\label{methods}

In this section, a detailed description of the model is given following 
the paradigm of Nordlie et al, \cite{nordlie:2009}. Therefore, a brief
description of the model, equations, parameters, and inputs are given in
the form of tables. 

Table~\ref{Table:1} provides a description of the model, Table~\ref{Table:2}
provides information about simulations duration and temporal integration time
steps, Table~\ref{Table:3} gives a glimpse of the input signals used in this work.
Table~\ref{Table:4} introduces the equations of the model and finally 
Table~\ref{Table:5} summarizes all the parameters for each figure (simulation).
The neuron model is conductance-based consisting of four differential equations
describing the dynamics of membrane potential and the kinetics of a T-Type
calcium current, a Sag current channel and a Potassium channel. The rest
currents are described by algebraic equations.
%%
\begin{table}[!htbp]
    \centering
    \begin{tabular}{ll}
        \thickhline
        \multicolumn{2}{c}{Model Summary} \\\thickhline
        \rowcolor{Gray}
        Populations  & No population -- one neuron model \\\rowcolor{LightGray}
        Topology     & -- \\ \rowcolor{Gray}
        Connectivity & -- \\ \rowcolor{LightGray}
        Neuron Model & Hodgkin-Huxley conductance-based \\\rowcolor{Gray}
        Channel Models & \\ \rowcolor{LightGray}
        Synapse Model & -- \\ \rowcolor{Gray}
        Plasticity & -- \\ \rowcolor{LightGray}
        Input & Constant current or periodic rectangular pulses \\\rowcolor{Gray}
        Measurements & Membrane potential, channels activation, phase plane \\
        \thickhline
    \end{tabular}
    \caption{{\bfseries \sffamily Summary of the model}} 
    \label{Table:1}
\end{table}
 %%  
The reference implementation has been done in a Python class (Python $3.5.1$)
along with Numpy (version $1.10.4$), Scipy (version $0.17.0$), Matplotlib
($1.5.1$) and Scikit-image (version $0.12.3$). The numerical integration
has been done using the \emph{ode} method of Scipy \emph{integrate} package.
Three different methods have been tested in this work (\emph{dopri5}, 
\emph{Adams}, \emph{BDF}, \cite{ascher:1998}). \emph{dopri5} is the closest
numerical method to the one used by the author in the original article (the
author has numerically integrated the system of the four ODEs by using a
fifth-order adaptive size Runge-Kutta method). \emph{BDF} and \emph{Adams}
provide similar numerical results as the first one, but they are
faster\footnote{The user has the option to choose one of the three methods
    during class instantiating. We tested all three methods comparing, spike
    times, amplitudes and the coefficient of variation using as threshold value
    $0\, \Rm{mV}$. Spike events were overlapping, and $CV \simeq 1.5$ for all
    three methods. The membrane potential amplitude was sometimes different
    for the same spike events, however that difference was not too high as
    Figure~\ref{Fig:1} shows (up to $4\, \Rm{mV}$ at maximum). Thus we decided
    to use the \emph{Adams} method.}.
%%
\begin{table}[!htbp]
    \centering
    \begin{tabular}{ccc}
        \thickhline
        \multicolumn{3}{c}{Simulation Time} \\ \thickhline
        Figure & Simulation Time ($\Rm{s}$) & Integration Step ($\Rm{ms}$) \\ 
        \rowcolor{LightGray}
        $1$ & $6$ & $0.05$ \\ \rowcolor{Gray}
        $2$ & $15\times period$, $2$ & $0.05$ \\ \rowcolor{LightGray}
        $3$ & $6$ & $0.05$ \\ \rowcolor{Gray} 
        $4$ & $1.5$, $1.5$, $1$ & $0.05$ \\ \rowcolor{LightGray} 
        $5$ & $5$ & $0.05$  \\ \rowcolor{Gray} 
        $6$ & $2.5$ & $0.05$  \\ \rowcolor{LightGray} 
        $7$ & $40$, $20$ & $0.05$  \\ \thickhline
    \end{tabular}
    \caption{{\bfseries \sffamily Simulations Time}}
    \label{Table:2}
\end{table}
%%  

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=0.6\textwidth]{figs/Figure1.pdf}
    \caption{{\bfseries \sffamily Spike waveform.} Three integration methods:
    Runge-Kutta $5$ (\emph{dopri5}), \emph{Adams}, and \emph{BDF} where tested
    in order to identify potential numerical differences in our simulations
    (see text for more details). The amplitude for the three methods have no
    significant differences for the randomly picked up spike waveform shown in 
    this figure (in general we detected differences up to $5\, \Rm{mV}$, data
    not shown here). Continuous line -- \emph{dopri5}, dashed line -- \emph{Adams},
    and dashed-dotted line -- \emph{BDF}.}
    \label{Fig:1}
\end{figure}

All simulations ran on a Dell OptiPlex $7040$, equipped with a sixth
generation i$7$ processor, $8\, \Rm{GB}$ of physical memory and running Arch
Linux.
The total execution time of all simulations was $526$ minutes and the peak
consumed memory was $465\, \Rm{MB}$\footnote{Python memory
    profiler used (\url{https://pypi.python.org/pypi/memory_profiler}).}\@. 
    All the parameters used during simulations are given in Table~\ref{Table:5}. 
%%
\begin{table}[!htbp]
    \centering
    \begin{tabular}{llcccc}
        \thickhline
        \multicolumn{6}{c}{Input} \\\thickhline
        Figure  & Type & Form & \parbox[t]{1.5cm}{Frequency
            ($\frac{1}{P_0}$, $\Rm{Hz}$)} & 
            \parbox[t]{1.5cm}{Duration ($p$, $\Rm{ms}$)} &
            \parbox[t]{1.5cm}{Amplitude ($\mu \Rm{A} / \Rm{cm}^2$)} \\
        \thickhline \rowcolor{LightGray}
        Figure~$1$ & Constant & 
            \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
            -- & -- & \parbox[c]{0.3cm}{$-0.6$}
            \\\rowcolor{Gray}
        Figure~$2$ & Periodic & 
            \includegraphics[width=0.1\textwidth]{figs/pulse.pdf} &
            \parbox[t]{1.1cm}{$5$, $10$} &
            \parbox[t]{1.1cm}{$10$, $40$} &
            \parbox[c]{0.3cm}{$-1.0$}
            \\\rowcolor{Gray}
        Figure~$3$ & Constant  & 
        \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
        -- & -- & \parbox[c]{0.3cm}{$+3.0$ \\ $3$ $0.0$ $-0.45$ $-0.455$
            $-0.47$ $-0.55$ $-0.6$ $-0.8$ $-1.3$ $-1.4$ $-2.1$} 
        \\\rowcolor{LightGray}
        Figure~$4$ & Pulse/Constant  & 
            \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
            -- & \parbox[c]{0.3cm}{100} & \parbox[c]{0.3cm}{$-1.25$ $0.25$ $-0.47$}
        \\\rowcolor{Gray}
        Figure~$5$ & Constant  & 
            \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
            -- & -- & \parbox[c]{0.3cm}{$-0.95$}
        \\\rowcolor{LightGray}
        Figure~$6$ & Constant  & 
            \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
            -- & -- & \parbox[c]{0.3cm}{$[-2,0]$}
        \\\rowcolor{Gray}
        Figure~$7$ & Constant  & 
            \includegraphics[width=0.1\textwidth]{figs/const.pdf} &
            -- & -- & \parbox[c]{0.3cm}{$[-2,0]$} \\
        \thickhline
    \end{tabular}
    \caption{{\bfseries \sffamily Description of the applied current
        $I_{\text{app}}$ }}
    \label{Table:3}
\end{table}
%%  

%%
\begin{table}[!htbp]
    \centering
    \begin{tabular}{p{1.5cm}ll}
        \thickhline
        \multicolumn{2}{c}{Neuron Model} \\\thickhline
        \rowcolor{Gray}
        Name  &  Thalamocortical relay neuron  \\ \rowcolor{LightGray}
        Type  &  Conductance-based neuron  \\ \rowcolor{Gray}
        Membrane Potential & $
            \begin{aligned}
                C_{\Rm{m}} \frac{dV(t)}{dt} &= -I_{\Rm{T}} - I_{\Rm{h}} - 
                I_{\Rm{Na}} - I_{\Rm{K}} - I_{\Rm{Na(P)}} - I_{\Rm{L}} +
                I_{\text{app}}
              \end{aligned}$ \\ \rowcolor{LightGray}
        T-Type Calcium Current ($I_T$) & $
            \begin{aligned}
                I_{\Rm{T}} &= g_{\Rm{T}} \cdot s^3_{\infty}(V)\cdot h \cdot
                (V-V_{\Rm{Ca}}) \\
                s_{\infty}(V) &= \frac{1}{1 + \exp(-\frac{V+65}{7.8})} \\
                \frac{dh(t)}{dt} &= \phi_h \frac{h_{\infty}(V) - h}{\tau_h(V)} \\
                h_{\infty}(V) &= \frac{1}{1 + \exp(\frac{V-\theta_h}{k_h})} \\
                \tau_h(V) &= h_{\infty}\exp(\frac{V+162.3}{17.8}) + 20
            \end{aligned} $
            \\ \rowcolor{Gray}
        Sag Current ($I_h$) & $
            \begin{aligned}
                I_h &= g_h \cdot H^2 \cdot (V-V_h) \\
                H_{\infty}(V) &= \frac{1}{1 + \exp(\frac{V+69}{7.1})} \\
                \frac{dH(t)}{dt} &= \phi_H \frac{H_{\infty}(V) - H}{\tau_H(V)} 
            \end{aligned} $
            \\ \rowcolor{LightGray} 
        Hodgkin-Huxley Currents ($I_K$) and ($I_{Na}$) & $
            \begin{aligned}
                I_{\Rm{K}} &= g_K \cdot n^4 \cdot (V - V_{\Rm{K}}) \\
                \frac{dn(t)}{dt} &= \phi_n \frac{n_{\infty}(V) - n(t)}{\tau_n(V)} \\
                n_{\infty}(\sigma_{\Rm{K}}, V) &=
                \frac{\alpha_n(\sigma_{\Rm{K}}, V)}
                {\alpha_n(\sigma_{\Rm{K}}, V) + \beta_n(\sigma_{\Rm{K}}, V)} \\
                \tau_n(\sigma_{\Rm{K}}, V) &= \frac{1}{\alpha_n(\sigma_{\Rm{K}}, V)
                + \beta_n(\sigma_{\Rm{K}}, V)} \\
                \alpha_n(\sigma_{\Rm{K}}, V) &= 
                \frac{-0.01 (V + 45.7 - \sigma_{\Rm{K}})}{\exp(-0.1(V + 45.7 - \sigma_{\Rm{K}})) - 1} \\ 
                \beta_n(\sigma_{\Rm{K}}, V) &= 0.125 \exp(-\frac{V + 55.7 -
                    \sigma_{\Rm{K}}}{80}) \\
                I_{\Rm{Na}} &= g_{\Rm{Na}} \cdot m^3_{\infty}(\sigma_{\Rm{Na}}, V)
                \cdot (0.85 - n) \cdot (V - V_{\Rm{Na}}) \\
                m_{\infty}(V) &= \frac{\alpha_m(\sigma_{\Rm{Na}}, V)}
                {\alpha_m(\sigma_{\Rm{Na}}, V) + \beta_m(\sigma_{\Rm{Na}}, V)} \\
                \alpha_m(\sigma_{\Rm{Na}}, V) &= -0.1 \frac{V + 29.7 -
                    \sigma_{\Rm{Na}}}
                    {\exp(-0.1(V + 54.7 - \sigma{\Rm{Na}})) - 1} \\
                    \beta_m(\sigma_{\Rm{Na}}, V) &=
                    4\exp(-\frac{V+54.7-\sigma_{\Rm{Na}}}{18})
            \end{aligned} $ \\ \rowcolor{Gray} 
        Persistent Sodium Currents ($I_{Na(P)}$) & $
                \begin{aligned}
                    I_{\Rm{Na(P)}} &= g_{\Rm{Na(P)}} \cdot
                    m^3_{\infty}(\sigma_{\Rm{Na(P)}},
                    V) \cdot (V - V_{\Rm{Na}}) \\
                \end{aligned} $
            \\ \rowcolor{LightGray}
        Leak Current ($I_L$) &  $
            \begin{aligned}
                I_L &= g_L \cdot (V - V_L) \\
            \end{aligned} $ \\ \thickhline
    \end{tabular}
    \caption{{\bfseries \sffamily Description of the neuron model}} 
    \label{Table:4}
\end{table}
%%

%%
\begin{landscape}
\begin{table}[!htbp]
    \centering
    \begin{tabular}{cccccccc}
        \thickhline
        \multicolumn{8}{c}{Model Parameters} \\\thickhline
        Figure & $V_0\, (\Rm{mV})$ & $g_T\, (\Rm{mS/cm^2})$ & $\theta_h\,
        (\Rm{mV})$ & $k_h\, (\Rm{mV^{-1}})$ & $\sigma_{Na}\, (\Rm{mV})$ &
        $g_L\, (\Rm{mS/cm^2})$ & $V_L\, (\Rm{mV})$ \\\rowcolor{LightGray}
        \thickhline
        $1$ & $-74$ & $1$ & $-79$ & $-5$ & $6$ & $0.12$ & $-70$ \\\rowcolor{Gray}
        $2$ & $-74$ & $1$ & $-81$ & $6.25$ & $3$ & $0.1$ & $-72$ \\\rowcolor{LightGray}
        $3$ & $-74$ & $0.3$ & $-79$ & $5$ & $6$ & $0.12$ & $-70$ \\\rowcolor{Gray}
        $4$ & $-72$/$-64$ & $1.0$ & $-79$ & $5$ & $6$ & $0.12$ & $-70$ \\\rowcolor{LightGray}
        $5$ & $-74$ & $0.3$ & $-75$ & $5$ & $6$ & $0.08$ & $-70$ \\\rowcolor{Gray}
        $6$ & $-74$ & $1$/$0.7$ & $-79$ & $5$ & $6$ & $0.1$/$0.04$ & $-70$ \\\rowcolor{LightGray}
        $7$ & $-72$ & $0.3$/$0.25$ & $-81$ & $6.25$ & $3$ & $0.1$ & $-72$ \\
        \thickhline
        \multicolumn{8}{l}{Common Parameters} \\\rowcolor{Gray}
        \multicolumn{8}{c}{$C_m = 1\, \Rm{\mu F/cm^2}$, $\phi_h = 2$,
        $V_{\Rm{Ca}} = 120\, \Rm{mV}$, $\phi_H = 1$, $g_h = 0.04\,
        \Rm{mS/cm^2}$, $V_h = -40\, \Rm{mV}$, $g_{\Rm{K}} = 30\, \Rm{mS/cm^2}$,
        $V_{\Rm{K}} = -80\, \Rm{mV}$, $g_{\Rm{Ca}} = 42\, \Rm{mS/cm^2}$} \\\rowcolor{Gray}
        \multicolumn{8}{c}{$V_{\Rm{Ca}} = 55\, \Rm{mV}$, $\phi_{n} = 28.5$,
        $\sigma_{\Rm{K}} = 10\, \Rm{mV}$, $V_{\Rm{Na(P)}} = 55\, \Rm{mV}$,
        $\sigma_{\Rm{Na(P)}} = -5\, \Rm{mV}$, $g_{\Rm{Na(P)}} = 9 \,
        \Rm{mS/cm^2}$}
        \\\thickhline
    \end{tabular}
    \caption{\bfseries \sffamily Simulation Parameters}
    \label{Table:5}
\end{table}
\end{landscape}
%%

\section{Results}\label{results}

We simulated the model described in Table~\ref{Table:4} using the parameters
given in Table~\ref{Table:5} and the corresponding input (see 
Table~\ref{Table:3}). First, we examined what is the response of the reference 
implementation to rhythmic hyperpolarization. In \cite{wang:1994} this is 
illustrated in Fig~$1$\footnote{From now and then all the 
    figures of the original article will be referred as Fig} of the original
article. 
Thus, we applied a periodic current pulse of $-1\,\Rm{\mu A/cm^2}$ amplitude at
several different frequencies ($\frac{1}{P_0}$ is the frequency in $\Rm{Hz}$
and $P_0$ is the corresponding period in $\Rm{ms}$) ranging from 
$0.1\,\Rm{Hz}$ to $15\,\Rm{Hz}$ with a resolution (discretization) of $30$ 
points. The same number of samples used for discretizing the duration for each 
frequency. The results are shown in Figure~\ref{Fig:2} left panel. Right panel
shows three different simulations of the reference implementation at specific
frequencies ($10,\, 5,\, 0.5\, \Rm{Hz}$) and rations $p/P_0$ ($0.1, 0.6, 0.6$),
respectively (crossed area in Figure~\ref{Fig:2} reflects the transient, which 
is omitted in the rest of the figures in this work). It is apparent that right
and left panels are in an agreement indicating that the reference model
produces reliable results. 
The author in \cite{wang:1994} shows in Fig~$1$ a shaded are where the number 
of spikes is $0.5$. This number appears if one computes the average of 
suprathreshold and subthreshold spikes in one period.  

%%
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=1.1\textwidth]{figs/Figure2.pdf}
    \caption{{\bfseries \sffamily Responses to rhythmic hyperpolarizations.}
        We stimulate the model with a periodic pulse with varying frequency
        $\frac{1}{P_0}$ in $[0.1, 15]Hz$ and ON pulse duration $p$. 
        {\bfseries \sffamily Left Panel:} shows a range of frequencies
        $\frac{1}{P_0}$ from $0.1Hz$ to $15Hz$ versus the ratio
        $\frac{p}{P_0}$ in range $[0, 1]$. Numbers indicate the number of 
        spikes per period. 
        {\bfseries \sffamily Right Panels:} In all these plots the 
        crossed area corresponds to the transient, and thus it has to be
        omitted. 
        {\bfseries \sffamily Red} color demonstrates a case where only
        subthreshold spikes are generated, when the frequency of the periodic
        pulse is $\frac{1}{P_0} = 10 Hz$ and $\frac{p}{P_0} = 0.1$. 
        {\bfseries \sffamily Blue} indicates bursts of four spike, when the
        frequency is $\frac{1}{P_0} = 5Hz$ and $\frac{p}{P_0} = 0.6$.
        {\bfseries \sffamily Black} shows a case of two spikes bursts. Here
        the frequency is $\frac{1}{P_0} = 0.5 Hz$ and $\frac{p}{P_0} = 0.6$.}
    \label{Fig:2}
\end{figure}
%%

Then we tested the transition from subthreshold to bursting oscillation via 
chaos. Therefore, we used a steady current varying only its amplitude keeping
all the other parameters fixed. We used eight different values (exactly the
same as in \cite{wang:1994}),
$$I_{\text{app}} =
3.0, 0.0, -0.45, -0.455, -0.47, -0.55, -0.6, -0.8, -1.3, -1.4, -2.0\, 
\Rm{\mu A /cm^2}.$$ Results are depicted in Figure~\ref{Fig:3}. This figure
corresponds to Fig~$3$ of \cite{wang:1994}. In this case, there was no
difference between the reference implementation and the original one. 
%%
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=1.\textwidth]{figs/Figure3.pdf}
    \caption{{\bfseries \sffamily Dynamic behavior of neuron.} Here we
    simulate the model with parameters given in Table~\ref{Table:5}. The
    only parameter that varies from panel to panel in this figure is the
    external current $I_{\text{ext}}$. These results correspond to Fig~$3$ 
    of \cite{wang:1994}.}
    \label{Fig:3}
\end{figure}
%%

The next simulation we performed reproduces results related to hysteresis as
in Fig~$4$ of \cite{wang:1994}. First, we run a simulation where the input 
current $I_{ext}$ varied from $-0.433\, \Rm{\mu A / cm^2}$ to $-0.55 \mu A /cm^2$.
At every iteration, we detected if there is subthreshold and/or suprathreshold 
activity in the membrane voltage trace. Thus we created the hysteresis diagram
given in Figure~\ref{Fig:4}, left panel. 
%%
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=1.1\textwidth]{figs/Figure4.pdf}
    \caption{{\bfseries \sffamily Hysteresis near the transition from the
    subthreshold to bursting oscillation.} {\bfseries \sffamily Left panel:}
    Hysteresis diagram indicates a coexistence of bursting and subthreshold 
    activity. {\bfseries \sffamily Upper right panel:} Bistability example
    shows how the same system can produce either subthreshold activity (black
    curve) or burst activity (gray curve). {\bfseries \sffamily Middle right 
    panel:} shows the activation of $H$ for the same simulation as in the upper 
    panel. {\bfseries  \sffamily Lower right panel:} Input to the model for
    this simulation is a brief current pulse at $0.25\, \Rm{\mu A /cm^2}$
    (black curve) and $-1.2\, \Rm{\mu A/cm^2}$ (gray curve) followed by a
    steady current at $-0.47\, \Rm{\mu A/cm^2}$ for both simulations. }
    \label{Fig:4}
\end{figure}
%%
In addition, we tested the bistability of the current model using the same 
protocol as in \cite{wang:1994}. According to that protocol, we first apply 
a brief pulse (for $100\, \Rm{ms}$) of $0.25\, \Rm{\mu A /cm^2}$ and
$-1.2\, \Rm{\mu A/cm^2}$ followed by a steady current at $-0.47\, 
\Rm{\mu A /cm^2}$. This causes the state of the model to switch from a purely 
subthreshold activity pattern to a mixed sub- and suprathreshold activity
pattern. The results are given in Figure~\ref{Fig:4}, right panel. 

Another interesting behavior of the model is the development of a ``spiral''
chaos (see Fig~$6$ in \cite{wang:1994}). The reference implementation is 
capable of generating similar behavior as Figure~\ref{Fig:5} shows. In order
to get these results we applied a constant external current with an amplitude
of $-0.95\, \Rm{\mu A / cm^2}$. 
%%
\begin{figure}[!htbp]
    \centering
    \includegraphics[width=.7\textwidth]{figs/Figure5.pdf}
    \caption{{\bfseries \sffamily ``Spiral Chaos''.} In this Figure
    we show that the model is capable of generating ``spiral chaos''
    as it has been shown in Fig~$6$ in \cite{wang:1994}.
    The external current in this simulation is constant ($-0.95\Rm{\mu A/cm^2}$). 
    {\bfseries \sffamily Top panel} shows the phase portrait of the 
    membrane potential and the Sag current ($V$ vs $h$).
    {\bfseries \sffamily Middle panel} illustrates the membrane potential ($V$)
    and, the {\bfseries \sffamily bottom panel} shows the $h$ current over time.}
    \label{Fig:5}
\end{figure}
%%

The next simulation investigates how the bursting frequency is affected by 
the injected external current (see Fig~$7$ in \cite{wang:1994}, two bursting
modes). To address this issue we captured data\footnote{Data are available in
    the accompanying github repository of the present article.} values for
the external current from Fig~$7$ of the original article (dots in Fig $7$,
pg. $27$ in \cite{wang:1994}) using a software called 
PlotDigitizer\footnote{\url{(http://plotdigitizer.sourceforge.net/})}.
The results from our simulations are illustrated in Figure~\ref{Fig:6}. Black
curve represents the frequency in $\Rm{Hz}$ and the blue one the period in 
$\Rm{sec}$. Provided results here are not as smooth as the original ones in
\cite{wang:1994}. Unfortunately there are no many details in the original 
article about these diagrams so we cannot reproduce them in full details. 
%%
\begin{figure}[!htbp]
    \includegraphics[width=1.1\textwidth, left]{figs/Figure6.pdf}
    \caption{{\bfseries \sffamily Frequency and period versus steady input 
    current.} This figure illustrates how the external current (ranging
    from $0$ to $-2\, \Rm{\mu A/cm^2}$ affects the bursts frequency (bursting
    mode) of the model. Black curve indicates the frequency in $\Rm{Hz}$
    and the blue curve the period in $\Rm{sec}$. The external
    current varies exactly as in Fig~$7$ in \cite{wang:1994} (see text for
    more details). }
    \label{Fig:6}
\end{figure}
%%

The last simulation is related to Fig~$2$ of \cite{wang:1994} and to an
``intermittent'' phase-locking phenomenon. A periodic pulse with frequency 
$10\,\Rm{Hz}$ and ratio $\frac{p}{P_0} = 0.8$ is applied to the model as
external input current. The response of the model is registered and sub- and
supra-threshold spikes are counted. We applied six different current amplitudes
and two different values for the T-type calcium conductance. 
$I_{app} = -1.4, -1.5, -1.6\, \Rm{\mu A /cm^2}$ and $g_T = 0.3\, \Rm{mS/cm^2}$
$I_{app} = -1.2, -1.5, -1.8\, \Rm{\mu A/cm^2}$ and  $g_T = 0.25\,
\Rm{mS/cm^2}$. Figure~\ref{Fig:7} shows $2$ seconds of membrane potential 
along with symbolic patterns of $0$ (dark circles) and $1$ (green line
segments). Results given in Figure~\ref{Fig:7} are similar to the ones of
Fig~$2$A and Fig~$2$B in \cite{wang:1994}.
%%
\begin{figure}[!htbp]
    \includegraphics[width=1.1\textwidth]{figs/Figure7.pdf}
    \caption{{\bfseries \sffamily Symbolic patterns.} Six different simulations
    are illustrated here ($I_{app} = -1.4, -1.5 -1.6 \, \Rm{\mu A/cm^2}$
    with $g_T = 0.3\, \Rm{mS / cm^2}$) and ($I_{app} = -1.2, -1.5, -1.8\,
    \Rm{\mu A / cm^2}$ with $g_T = 0.25\, \Rm{mS / cm^2}$). Symbolic patterns
    are illustrated above membrane potential traces as green line segments -- 
    suprathreshold spikes and dark circles -- subthreshold spikes. Red curve 
    indicates the input periodic pulses.}
    \label{Fig:7}
\end{figure}
%%

\section{Conclusion}\label{conclusion}

A conductance-based model for relay thalamocortical neurons proposed 
by \cite{wang:1994} was implemented in Python. The model tested 
thoroughly in several examples taken from the original article. 
In general, the original model was easy to be implemented since all the
equations and the most of the parameters (except the initial time step of the
integration method) are given. The reference implementation results are similar
to the original ones. Unfortunately, we could not find any other implementation
of the original model described in \cite{wang:1994} to compare with. 

{\sffamily \small
  \printbibliography[title=References]
}
\end{document}
